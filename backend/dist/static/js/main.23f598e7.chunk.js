(this.webpackJsonppatientor=this.webpackJsonppatientor||[]).push([[0],{116:function(e,t,n){},223:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(75),o=n.n(i),s=(n(196),n(15)),l=n(10),d=n(11),u=n.n(d),j=n(9),b=n(78),h=n.n(b),p=null!==(a="https://localhost:3001/api")?a:"https://localhost:3001/api";h.a.defaults.baseURL=p,h.a.defaults.withCredentials=!0;var O,v,f,m,x=function(e){h.a.defaults.headers.common={Authorization:"Bearer ".concat(e||"")}},g=h.a,y=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("/patients");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("/patients/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("/users/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(e){var t=/^.+\.(.+)\..+$/.exec(e);return t&&2===t.length?Object(j.a)({token:e},JSON.parse(atob(t[1]))):null},E=function(){var e=Object(s.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.post("/auth",{username:t,password:n});case 2:return a=e.sent,r=w(a.data),x(null===r||void 0===r?void 0:r.token),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.delete("/auth",{data:{id:t}});case 2:return n=e.sent,h.a.defaults.headers.common=Object(j.a)(Object(j.a)({},h.a.defaults.headers.common),{},{Authorization:"Bearer "}),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(s.a)(u.a.mark((function e(t,n,a,r){var c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.post("/users",{username:t,password:n,name:a,roles:r});case 2:return c=e.sent,i=c.data,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.put("/auth");case 2:return t=e.sent,e.abrupt("return",w(t.data));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=g,R=n(70),L=n(17),T=n(237),F=n(248),H=n(160),I=n(240),V=n(245),_=n(40),M={},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PATIENT_LIST":return t.payload.reduce((function(e,t){return Object(j.a)(Object(j.a)({},e),{},Object(_.a)({},t.id,t))}),{});case"ADD_PATIENT":return Object.assign({},e,Object(_.a)({},t.payload.id,t.payload));case"REMOVE_PATIENT":return Object.fromEntries(Object.entries(e).filter((function(e){return Object(l.a)(e,1)[0]!==t.payload})));default:return e}},Y={},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DIAGNOSIS_LIST":return t.payload.reduce((function(e,t){return Object(j.a)(Object(j.a)({},e),{},Object(_.a)({},t.code,t))}),{});case"ADD_DIAGNOSIS":return Object.assign({},e,Object(_.a)({},t.payload.code,t.payload));case"REMOVE_DIAGNOSIS":return Object.fromEntries(Object.entries(e).filter((function(e){return Object(l.a)(e,1)[0]!==t.payload})));default:return e}},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.payload;case"LOGOUT":return null;default:return e}},P=n(94),z=[],q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_SCHEDULED":return[].concat(Object(P.a)(e),[t.payload]);case"REMOVE_SCHEDULED":return e.slice(1);case"REMOVE_ALL_SCHEDULED":return[];default:return e}},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DISPLAY_MESSAGE":return Object(j.a)(Object(j.a)({},t.payload),{},{show:!0});case"CLEAR_MESSAGE":return null;default:return e}},$=n(1),Z={patients:{},diagnoses:{},auth:null,scheduler:[],message:null},Q=Object(r.createContext)([Z,function(){return Z}]),K=function(e){var t=e.reducer,n=e.children,a=Object(r.useReducer)(t,Z),c=Object(l.a)(a,2),i=c[0],o=c[1];return Object($.jsx)(Q.Provider,{value:[i,o],children:n})},W=function(){return Object(r.useContext)(Q)},X=function(e){return{type:"SET_PATIENT_LIST",payload:e}},ee=function(e){return{type:"ADD_PATIENT",payload:e}},te=function(e){return{type:"REMOVE_PATIENT",payload:e}},ne=function(e){return{type:"SET_DIAGNOSIS_LIST",payload:e}},ae=function(e){return{type:"ADD_DIAGNOSIS",payload:e}},re=function(e){return{type:"REMOVE_DIAGNOSIS",payload:e}},ce=function(e){return{type:"LOGIN",payload:e}},ie=function(e){return{type:"DISPLAY_MESSAGE",payload:e}};!function(e){e.Male="male",e.Female="female",e.Other="other"}(O||(O={})),function(e){e.HealthCheckEntry="HealthCheck",e.HospitalEntry="Hospital",e.OccupationalHealthcareEntry="OccupationalHealthcare"}(v||(v={})),function(e){e[e.Healthy=0]="Healthy",e[e.LowRisk=1]="LowRisk",e[e.HighRisk=2]="HighRisk",e[e.CriticalRisk=3]="CriticalRisk",e[e.Undetermined=-1]="Undetermined"}(f||(f={})),function(e){e.error="error",e.info="info",e.warning="warning",e.success="success"}(m||(m={}));var oe,se,le=n(235),de=n(48),ue=n(92),je=n(153),be=n(159),he=n(182),pe=n(12),Oe=n(242),ve=function(e){var t=e.name,n=e.label,a=e.options;return Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:n}),Object($.jsx)(pe.b,{as:"select",name:t,className:"ui dropdown",children:a.map((function(e){return Object($.jsx)("option",{value:e.value,children:e.label||e.value},e.value)}))})]})},fe=function(e){var t=e.field,n=e.label,a=e.placeholder,r=e.type;return Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:n}),Object($.jsx)(pe.b,Object(j.a)({type:r,placeholder:a},t)),Object($.jsx)("div",{style:{color:"red"},children:Object($.jsx)(pe.a,{name:t.name})})]})},me=function(e){if(!e||!String(e).trim().length)return"";if("string"===typeof e||e instanceof Date){if(Number.isNaN(Date.parse(e)))throw new Error("Invalid date");var t=new Date(e).toLocaleDateString("en-us",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/");return"".concat(t[2],"-").concat(t[0],"-").concat(t[1])}throw new Error("Date must be of type string or Date")},xe=function(e){var t=e.field,n=e.label,a=e.placeholder,c=e.dateFormatter,i=void 0===c?me:c,o=e.setFieldTouched,s=e.setFieldValue;return Object(r.useEffect)((function(){void 0===t.value&&null===t.value||(s(t.name,i(t.value)),o(t.name,!1))}),[]),Object(r.useEffect)((function(){/\d{1,2}-\d{1,2}-\d{4}/g.test(t.value)&&(s(t.name,i(t.value)),o(t.name,!0))}),[t.value]),Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:n}),Object($.jsx)(pe.b,Object(j.a)({type:"date",placeholder:a},t)),Object($.jsx)("div",{style:{color:"red"},children:Object($.jsx)(pe.a,{name:t.name})})]})},ge=n(112),ye=function(e){var t=e.field,n=e.diagnoses,a=e.setFieldValue,r=e.setFieldTouched,c=e.initialValues,i=e.onSearchChange,o=n.map((function(e){return{key:e.code,text:"".concat(e.name," (").concat(e.code,")"),value:e.code}}));return Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:"Diagnoses"}),Object($.jsx)(ge.a,{fluid:!0,multiple:!0,search:!0,selection:!0,options:o,onChange:function(e,n){r(t.name,!0),a(t.name,n.value)},defaultValue:c||void 0,onSearchChange:i}),Object($.jsx)(pe.a,{name:t.name})]})},ke=function(e){var t=e.field,n=e.entryTypes,a=e.setFieldValue,r=e.setFieldTouched,c=e.initialValue,i=n.map((function(e){return{key:e,text:e.split(/([A-Z][a-z]+)/g).filter((function(e){return""!==e})).join(" "),value:e}}));return Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:"Entry type"}),Object($.jsx)(ge.a,{fluid:!0,search:!0,selection:!0,options:i,onChange:function(e,n){r(t.name,!0),a(t.name,n.value)},defaultValue:c||void 0}),Object($.jsx)(pe.a,{name:t.name})]})},Ce=[{value:O.Male,label:"Male"},{value:O.Female,label:"Female"},{value:O.Other,label:"Other"}],we=function(e){var t=e.onSubmit,n=e.onCancel,a=e.initialValues;return Object($.jsx)(pe.d,{initialValues:a||{name:"",ssn:"",dateOfBirth:"",occupation:"",gender:O.Other},onSubmit:t,validate:function(e){var t="Field is required",n={};return e.name||(n.name=t),e.ssn||(n.ssn=t),e.dateOfBirth||(n.dateOfBirth=t),e.occupation||(n.occupation=t),n},children:function(e){var t=e.isValid,r=e.dirty;return Object($.jsxs)(pe.c,{className:"form ui",children:[Object($.jsx)(pe.b,{label:"Name",placeholder:"Name",name:"name",component:fe}),Object($.jsx)(pe.b,{label:"Social Security Number",placeholder:"SSN",name:"ssn",component:fe}),Object($.jsx)(pe.b,{label:"Date Of Birth",placeholder:"YYYY-MM-DD",name:"dateOfBirth",component:fe}),Object($.jsx)(pe.b,{label:"Occupation",placeholder:"Occupation",name:"occupation",component:fe}),Object($.jsx)(ve,{label:"Gender",name:"gender",options:Ce}),Object($.jsxs)(he.a,{children:[Object($.jsx)(he.a.Column,{floated:"left",width:5,children:Object($.jsx)(H.a,{type:"button",onClick:n,color:"red",children:"Cancel"})}),Object($.jsx)(he.a.Column,{floated:"right",width:5,children:Object($.jsx)(H.a,{type:"submit",floated:"right",color:"green",disabled:!r||!t,children:a?"Change":"Add"})})]})]})}})},Ee=function(e){var t=e.modalOpen,n=e.onClose,a=e.onSubmit,r=e.error,c=e.initialValues;return Object($.jsxs)(je.a,{open:t,onClose:n,centered:!1,closeIcon:!0,children:[Object($.jsx)(je.a.Header,{children:"Add a new patient"}),Object($.jsxs)(je.a.Content,{children:[r&&Object($.jsx)(be.a,{inverted:!0,color:"red",children:"Error: ".concat(r)}),Object($.jsx)(we,{onSubmit:a,onCancel:n,initialValues:c})]})]})},Se=n(247),De=(n(116),["The patient is in great shape","The patient has a low risk of getting sick","The patient has a high risk of getting sick","The patient has a diagnosed condition","Health rating undetermined"]),Ne={opacity:.2,filter:"grayscale(100%)"},Ae=f.CriticalRisk+1,Re=function(e){var t=e.rating,n=e.showText,a=e.inlineText,r=void 0!==a&&a;return Object($.jsxs)("div",{className:"health-bar",children:[t===f.Undetermined?Object($.jsx)(Se.a,{icon:"heart",disabled:!0,rating:0,maxRating:Ae,style:Ne}):Object($.jsx)(Se.a,{icon:"heart",disabled:!0,rating:4-t,maxRating:Ae}),n?Object($.jsx)("p",{style:{display:r?"inline":void 0},className:r?"health-rating-text-inline":void 0,children:De[t]||De[4]}):null]})},Le=n(244),Te=function(e){var t=e.data,n=e.header,a=e.sortFunc,r=e.actions,i=c.a.useState({key:void 0,order:void 0}),o=Object(l.a)(i,2),s=o[0],d=o[1],u=function(e,t){"click"===e.type?d((function(e){var n;return{key:t,order:null===(n=!e.order)||void 0===n||n}})):"contextmenu"===e.type&&(e.preventDefault(),d({key:void 0,order:void 0}))};return t&&t.length?Object($.jsxs)(Le.a,{celled:!0,children:[Object($.jsx)(Le.a.Header,{className:"sticky-header",children:Object($.jsxs)(Le.a.Row,{children:[n.map((function(e){var t=e.key,n=e.sortable,a=e.alias;return Object($.jsxs)(Le.a.HeaderCell,{onClick:n?function(e){return u(e,t)}:null,onContextMenu:n?function(e){return u(e,t)}:null,style:{cursor:n?"pointer":"hand"},singleLine:!0,children:[null!==a&&void 0!==a?a:"".concat(t[0].toLocaleUpperCase()).concat(t.substring(1)),n&&Object($.jsx)(de.a,{name:s.order?"triangle up":"triangle down",style:{opacity:s.key===t?void 0===s.key?0:1:0}})]},t)})),(null===r||void 0===r?void 0:r.length)&&Object($.jsx)(Le.a.HeaderCell,{children:"Actions"})]})}),Object($.jsx)(Le.a.Body,{children:t.map((function(e){return e})).sort(a(s.key,s.order)).map((function(e,t){return Object($.jsxs)(Le.a.Row,{children:[n.map((function(n,a){var r,c=n.key;return function(e){var t,n,a;return!!e&&("TableCell"===(null===(t=e.type)||void 0===t?void 0:t.name)||"TableCell"===(null===(n=e.type)||void 0===n?void 0:n.displayName)||"td"===(null===(a=e.props)||void 0===a?void 0:a.as))}(e[c])?Object(j.a)(Object(j.a)({},e[c]),!e[c].key&&{key:"cell_".concat(t).concat(a)}):Object($.jsx)(Le.a.Cell,{children:null!==(r=e[c])&&void 0!==r?r:""},"cell_".concat(t).concat(a))})),(null===r||void 0===r?void 0:r.length)&&Object($.jsx)(Le.a.Cell,{singleLine:!0,children:Object($.jsx)("div",{children:r.map((function(a){return Object($.jsx)("div",{style:{display:"inline-block",cursor:"pointer"},onClick:function(){a.callback(e[a.arg])},children:Object($.jsx)(de.a,{name:a.iconName,title:a.label})},"cell_".concat(t).concat(n.length,"_action_").concat(a.label))}))})})]},"row_".concat(t))}))})]}):null},Fe=function(){var e=W(),t=Object(l.a)(e,2),n=t[0].patients,a=t[1],r=c.a.useState(!1),i=Object(l.a)(r,2),o=i[0],d=i[1],b=c.a.useState(),h=Object(l.a)(b,2),O=h[0],v=h[1],m=c.a.useState({value:"",show:!1}),x=Object(l.a)(m,2),g=x[0],y=x[1],k=function(){d(!1),v(void 0)},C=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.post("".concat(p,"/patients"),t);case 3:n=e.sent,r=n.data,a(ee(r)),k(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),A.isAxiosError(e.t0)&&(console.error((null===(c=e.t0.response)||void 0===c?void 0:c.data)||"Unknown Error"),v((null===(i=e.t0.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.error)||"Unknown error"));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object($.jsxs)("div",{className:"App",style:{position:"relative"},children:[Object($.jsx)(T.a,{textAlign:"center",children:Object($.jsx)("h3",{children:"Patient list"})}),Object($.jsxs)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end",position:"absolute",top:"-.25rem",right:"0"},children:[Object($.jsx)("div",{style:{display:"inline-block",opacity:Number(g.show),width:"25%",marginInlineEnd:".25em",transition:".2s"},children:Object($.jsx)(le.a,{value:g.value,fluid:!0,size:"small",placeholder:"filter by name",onChange:function(e){return y(Object(j.a)(Object(j.a)({},g),{},{value:e.target.value}))}})}),Object($.jsx)("div",{style:{display:"inherit",opacity:Number(g.show),cursor:g.value?"pointer":"auto"},onClick:function(){return g.value&&y(Object(j.a)(Object(j.a)({},g),{},{value:""}))},title:"clear filter",children:Object($.jsx)(de.a,{name:"close",inverted:!g.value,color:""===g.value?"grey":"black",style:{marginTop:".5em"}})}),Object($.jsx)("div",{style:{cursor:"pointer"},onClick:function(){return y(Object(j.a)(Object(j.a)({},g),{},{show:!(null!==g&&void 0!==g&&g.show)}))},title:"filtering is ".concat(g.value?"on":"off"),children:Object($.jsx)(de.a,{name:"filter",inverted:!g.show,style:{marginTop:".5em",transform:"scale(".concat(g.show?1:.8,")"),transition:".2s"},color:""===g.value?"grey":"black"})})]}),Object($.jsx)(Te,{data:Object.values(n).filter((function(e){return new RegExp(g.value,"i").test(e.name)})).map((function(e){return Object(j.a)(Object(j.a)({},e),{},{name:Object($.jsx)(R.b,{to:"/patients/".concat(e.id),children:e.name}),healthRating:Object($.jsx)(ue.a,{title:f[e.healthRating].replace(/([a-z])([A-Z])/g,"$1 $2"),children:Object($.jsx)(Re,{showText:!1,rating:e.healthRating})})})})),header:[{key:"name",sortable:!0},{key:"gender",sortable:!1},{key:"occupation",sortable:!0},{key:"healthRating",sortable:!0,alias:"Health Rating"}],sortFunc:function(e,t){return function(n,a){var r,c,i,o;return void 0===e?0:n[e]&&a[e]?"string"===typeof n[e]?n[e].localeCompare(a[e],"en",{sensitivity:"base"})*(t?1:-1):"number"===typeof n[e]?(n[e]-a[e])*(t?1:-1):"Link"===(null===(r=n[e].type)||void 0===r?void 0:r.name)||"Link"===(null===(c=n[e].type)||void 0===c?void 0:c.displayName)?n[e].props.children.localeCompare(a[e].props.children,"en",{sensitivity:"base"})*(t?1:-1):"TableCell"===(null===(i=n[e].type)||void 0===i?void 0:i.name)||"TableCell"===(null===(o=n[e].type)||void 0===o?void 0:o.displayName)?(n[e].props.children.props.rating-a[e].props.children.props.rating)*(t?1:-1):0:0}}}),Object($.jsx)(Ee,{modalOpen:o,onSubmit:C,error:O,onClose:k}),Object($.jsx)(H.a,{onClick:function(){return d(!0)},children:"Add New Patient"})]})},He=n(179),Ie=n(236),Ve=n(238),_e=n(239),Me=n(180),Ue=(oe={},Object(_.a)(oe,v.HospitalEntry,"hospital"),Object(_.a)(oe,v.HealthCheckEntry,"doctor"),Object(_.a)(oe,v.OccupationalHealthcareEntry,"stethoscope"),oe),Ye=function(e){var t=e.entry,n=e.actions,a=W(),i=Object(l.a)(a,2),o=i[0].diagnoses,s=i[1],d=function(){var e;return t.diagnosisCodes&&t.diagnosisCodes.length&&t.diagnosisCodes&&t.diagnosisCodes.reduce((function(e,t){return e&&void 0!==o[t]}),!0)?Object($.jsxs)(c.a.Fragment,{children:[Object($.jsx)("h4",{children:"Diagnosis"}),Object($.jsx)(Le.a,{collapsing:!0,compact:!0,singleLine:!1,className:"no-border no-padding-left medium-line-height",children:Object($.jsx)(Le.a.Body,{children:null===(e=t.diagnosisCodes)||void 0===e?void 0:e.map((function(e,t){return Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{style:{paddingTop:".3em"},children:Object($.jsx)(de.a,{fitted:!0,name:"circle",size:"tiny"})}),Object($.jsx)(Le.a.Cell,{children:e}),Object($.jsx)(Le.a.Cell,{children:o[e].name})]},t)}))})})]}):null};return Object(r.useEffect)((function(){var e;null===(e=t.diagnosisCodes)||void 0===e||e.forEach((function(e){void 0===o[e]&&A.get("".concat(p,"/diagnoses/").concat(e)).then((function(e){e.data&&s(ae(e.data))})).catch((function(e){console.log(e)}))}))}),[]),t?Object($.jsx)(Me.a,{variant:"outlined",fluid:!0,children:Object($.jsxs)(Me.a.Content,{children:[function(){switch(t.type){case v.HealthCheckEntry:return function(e){return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)("h2",{children:[e.date," ",Object($.jsx)(de.a,{name:Ue[e.type],title:"health check"})]}),Object($.jsx)("p",{children:Object($.jsx)("em",{children:e.description})}),Object($.jsx)(Le.a,{collapsing:!0,compact:!0,singleLine:!1,className:"no-border no-padding-left medium-line-height",children:Object($.jsxs)(Le.a.Body,{children:[Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Specialist"}),Object($.jsx)(Le.a.Cell,{children:e.specialist})]}),Object($.jsxs)(Le.a.Row,{verticalAlign:"top",children:[Object($.jsx)(Le.a.Cell,{children:"Health rating"}),Object($.jsx)(Le.a.Cell,{children:Object($.jsx)(Re,{rating:e.healthCheckRating,showText:!0,inlineText:!0})})]})]})}),d()]})}(t);case v.HospitalEntry:return function(e){return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)("h2",{children:[e.date," ",Object($.jsx)(de.a,{name:Ue[e.type],title:"hospital admission"})]}),Object($.jsx)("p",{children:Object($.jsx)("em",{children:e.description})}),Object($.jsx)(Le.a,{collapsing:!0,compact:!0,singleLine:!1,className:"no-border no-padding-left medium-line-height",children:Object($.jsxs)(Le.a.Body,{children:[Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Specialist"}),Object($.jsx)(Le.a.Cell,{children:e.specialist})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Discharged on"}),Object($.jsx)(Le.a.Cell,{children:e.discharge.date})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Discharge criteria"}),Object($.jsx)(Le.a.Cell,{children:e.discharge.criteria})]})]})}),d()]})}(t);case v.OccupationalHealthcareEntry:return function(e){var t,n;return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)("h2",{children:[e.date,"\xa0",Object($.jsx)(de.a,{name:Ue[e.type],title:"occupational healthcare"}),"\xa0",Object($.jsx)("span",{style:{padding:"4px",border:"1px solid",borderRadius:"4px",cursor:"default"},title:"employer",children:e.employerName})]}),Object($.jsx)("p",{children:Object($.jsx)("em",{children:e.description})}),Object($.jsx)(Le.a,{collapsing:!0,compact:!0,singleLine:!1,className:"no-border no-padding-left medium-line-height",children:Object($.jsxs)(Le.a.Body,{children:[Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Specialist"}),Object($.jsx)(Le.a.Cell,{children:e.specialist})]}),e.sickLeave&&Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Sick leave"}),Object($.jsxs)(Le.a.Cell,{children:[null===(t=e.sickLeave)||void 0===t?void 0:t.startDate," \u2014 ",null===(n=e.sickLeave)||void 0===n?void 0:n.endDate]})]})]})}),d()]})}(t);default:return function(e){throw new Error("Unhandled discriminated union member: ".concat(JSON.stringify(e)))}(t.type)}}(),Object($.jsx)("div",{style:{display:"inline-flex",width:"max-content",position:"absolute",top:"1.25rem",right:".5rem"},children:n.map((function(e){return Object($.jsx)("div",{onClick:function(){return e.callback(t)},style:{cursor:"pointer"},children:Object($.jsx)(de.a,{name:e.iconName,title:e.label})},"".concat(e.label))}))})]})}):null},Be=n(241),Ge=function(e){var t=e.onSubmit,n=e.onCancel,a=e.initialValues;return Object($.jsx)(pe.d,{initialValues:void 0===a?{code:"",name:"",latin:""}:a,onSubmit:t,validate:function(e){var t="Field is required",n={};return e.code||(n.name=t),e.name||(n.ssn=t),n},children:function(e){var t=e.isValid,r=e.dirty;return Object($.jsxs)(pe.c,{className:"form ui",children:[Object($.jsx)(pe.b,{label:"Code",placeholder:"Code",name:"code",component:fe}),Object($.jsx)(pe.b,{label:"Name",placeholder:"Name",name:"name",component:fe}),Object($.jsx)(pe.b,{label:"Latin",placeholder:"Latin",name:"latin",component:fe}),Object($.jsxs)(he.a,{children:[Object($.jsx)(he.a.Column,{floated:"left",width:5,children:Object($.jsx)(H.a,{type:"button",onClick:n,color:"red",children:"Cancel"})}),Object($.jsx)(he.a.Column,{floated:"right",width:5,children:Object($.jsx)(H.a,{type:"submit",floated:"right",color:"green",disabled:!r||!t,children:void 0===a?"Add":"Change"})})]})]})}})},Pe=n(110),ze=n(243),qe=function(e){var t=e.results,n=t.terms,a=t.results,r=e.onAdd,c=e.added;return Object($.jsx)(ze.a,{divided:!0,verticalAlign:"middle",children:a.length>0?a.map((function(e,t){var n=e.name,a=e.desc;return Object($.jsxs)(ze.a.Item,{children:[Object($.jsx)(ze.a.Content,{floated:"right",children:Object($.jsx)(H.a,{disabled:c[t],onClick:function(){r({name:n,desc:a},t)},children:"Add"})}),Object($.jsx)(ze.a.Header,{children:n}),Object($.jsx)(ze.a.Description,{children:Object($.jsx)("span",{children:a})})]},"".concat(n,"_").concat(t))})):void 0!==n?'no results for "'.concat(n,'"'):null})},Je=function(){var e,t=Object(r.useState)({terms:void 0,results:[],error:void 0}),n=Object(l.a)(t,2),a=n[0],i=a.terms,o=a.results,d=a.error,b=n[1],h=Object(r.useState)(!1),O=Object(l.a)(h,2),v=O[0],f=O[1],m=Object(r.useState)([]),x=Object(l.a)(m,2),g=x[0],y=x[1],k=W(),C=Object(l.a)(k,2),w=C[0].diagnoses,E=C[1],S=c.a.useRef(null),D=function(e){var t;if(e.terms)return{results:(null===e||void 0===e||null===(t=e.results)||void 0===t?void 0:t.map((function(e){return{name:e.name,desc:e.desc}})))||[],terms:e.terms};if(e.code){var n=e.to?e.to.codes.map((function(e){return{name:e.name,desc:e.desc}})):e.subcodes?e.subcodes.map((function(e){return{name:e.name,desc:e.desc}})):[];return{results:[{name:e.code.name,desc:e.code.desc}].concat(Object(P.a)(n)),terms:e.code.name}}return{terms:void 0,results:[]}},N=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a,r,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=20;break}return null===(n=document.getElementById("results-div"))||void 0===n||n.scrollTo(0,0),e.prev=2,f(!0),e.next=6,A.post("".concat(p,"/icdclookup"),{terms:t});case 6:a=e.sent,r=a.data,f(!1),c=D(r),b(Object(j.a)(Object(j.a)({},c),{},{terms:c.terms||t})),i=Object.keys(w),y(c.results?c.results.map((function(e){var t=e.name;return i.includes(t)})):[]),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0),b({results:[],terms:t,error:e.t0.message}),f(!1);case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(s.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.post("".concat(p,"/diagnoses"),{code:t.name,name:t.desc});case 3:E(ae({code:t.name,name:t.desc})),y(g.map((function(e,t){return t===n||e}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),b({terms:i,results:o,error:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}();return Object($.jsxs)(Oe.a,{children:[Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:"search terms"}),Object($.jsx)("input",{ref:S,type:"text",autoComplete:"off",id:"search-term",name:"search-term",onKeyUp:function(t){return function(t){var n;clearTimeout(e),/^[a-z 0-9-]{1}$|Backspace/i.exec(t.key)&&null!==(n=S.current)&&void 0!==n&&n.value&&(e=setTimeout((function(){var e;N((null===(e=S.current)||void 0===e?void 0:e.value)||"")}),750))}(t)}})]}),Object($.jsxs)("div",{id:"results-div",style:{minHeight:"10vh",maxHeight:"50vh",overflow:"auto"},className:v?"ui segment loading":void 0,children:[d&&Object($.jsx)(be.a,{inverted:!0,color:"red",children:"Error: ".concat(d)}),Object($.jsx)(qe,{results:{terms:i,results:o},onAdd:R,added:g})]}),Object($.jsx)("div",{style:{marginTop:"2vh"},children:Object($.jsxs)(Pe.a,{color:"blue",children:["powered by",Object($.jsx)(Pe.a.Detail,{as:"a",children:Object($.jsx)("span",{onClick:function(){return window.open("https://icdcodelookup.com","_blank","noreferrer,noopener")},children:Object($.jsx)("em",{children:"icdcodelookup"})})})]})})]})},$e=function(e){var t=e.modalOpen,n=e.onClose,a=e.onSubmit,r=e.error,c=e.initialValues;return Object($.jsxs)(je.a,{open:t,onClose:n,centered:!1,closeIcon:!0,children:[Object($.jsxs)(je.a.Header,{children:[void 0!==c?"Edit":"Add a"," diagnosis"]}),Object($.jsx)(je.a.Content,{children:Object($.jsx)(Be.a,{panes:[{menuItem:"add",render:function(){return Object($.jsxs)(Be.a.Pane,{children:[r&&Object($.jsx)(be.a,{inverted:!0,color:"red",children:"Error: ".concat(r)}),Object($.jsx)(Ge,{onSubmit:a,onCancel:n,initialValues:c})]})}},void 0===c?{menuItem:"search",render:function(){return Object($.jsx)(Be.a.Pane,{children:Object($.jsx)(Je,{})})}}:{}],renderActiveOnly:!0})})]})},Ze=function(e){var t=e.name,n=e.label,a=e.options,r=void 0===a?Object.entries(f).filter((function(e){var t=Object(l.a)(e,2),n=t[0];return-1!==t[1]&&/[a-z]+/i.test(n)})).map((function(e){var t=Object(l.a)(e,2),n=t[0];return{value:t[1],label:n.replace(/(.+[a-z])([A-Z].+)/g,"$1 $2")}})):a;return Object($.jsxs)(Oe.a.Field,{children:[Object($.jsx)("label",{children:n}),Object($.jsx)(pe.b,{as:"select",name:t,className:"ui dropdown",children:r.map((function(e){return Object($.jsx)("option",{value:e.value,children:e.label},e.value)}))})]})},Qe=function(e){var t,n,a,i,o=e.onSubmit,d=e.onCancel,j=e.initialValues,b=W(),h=Object(l.a)(b,2),O=h[0].diagnoses,m=h[1],x=Object(r.useState)(void 0),g=Object(l.a)(x,2),y=g[0],k=g[1],C=Object(r.useState)(!1),w=Object(l.a)(C,2),E=w[0],S=w[1],D=Object(r.useState)(void 0),N=Object(l.a)(D,2),R=N[0],L=N[1],T=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.post("".concat(p,"/diagnoses"),t);case 3:n=e.sent,m(ae(n.data)),S(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),A.isAxiosError(e.t0)?L(null===e.t0||void 0===e.t0||null===(a=e.t0.response)||void 0===a?void 0:a.data.message):L(e.t0.message),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),F=function(e,t){var n,a,r,c,i,o,s,l=null===(n=e.currentTarget.parentElement)||void 0===n||null===(a=n.lastElementChild)||void 0===a||null===(r=a.textContent)||void 0===r?void 0:r.toLowerCase().includes(t.searchQuery.trim().toLowerCase());l?null===(o=e.currentTarget.parentElement)||void 0===o||null===(s=o.lastElementChild)||void 0===s||s.classList.add("visible"):null===(c=e.currentTarget.parentElement)||void 0===c||null===(i=c.lastElementChild)||void 0===i||i.classList.remove("visible"),k({query:t.searchQuery.trim(),exists:l||!1})};return Object($.jsxs)(c.a.Fragment,{children:[Object($.jsx)(pe.d,{initialValues:j?{id:j.id,description:j.description,date:j.date,specialist:j.specialist,type:j.type,healthCheckRating:j.healthCheckRating||0,discharge:{date:(null===(t=j.discharge)||void 0===t?void 0:t.date)||"",criteria:(null===(n=j.discharge)||void 0===n?void 0:n.criteria)||""},employerName:j.employerName||"",sickLeave:{startDate:(null===(a=j.sickLeave)||void 0===a?void 0:a.startDate)||"",endDate:(null===(i=j.sickLeave)||void 0===i?void 0:i.endDate)||""},diagnosisCodes:j.diagnosisCodes||[]}:{description:"",date:new Date,specialist:"",type:"",healthCheckRating:0,discharge:{date:"",criteria:""},employerName:"",sickLeave:{startDate:"",endDate:""},diagnosisCodes:[]},onSubmit:o,validate:function(e){var t="Field is required",n={};return e.description||(n.description=t),e.date||(n.date=t),e.specialist||(n.specialist=t),e.type||(n.type=t),e.type===v.HealthCheckEntry&&void 0!==e.healthCheckRating&&(e.healthCheckRating<f.Healthy||e.healthCheckRating>f.CriticalRisk)&&(n.healthCheckRating=t),e.type===v.HospitalEntry&&(e.discharge&&!e.discharge.date&&(n.discharge=Object.assign({date:t},n.discharge)),e.discharge&&!e.discharge.criteria&&(n.discharge=Object.assign({criteria:t},n.discharge))),e.type===v.OccupationalHealthcareEntry&&(e.employerName||(n.employerName=t)),n},children:function(e){var t=e.isValid,n=e.dirty,a=e.setFieldValue,r=e.setFieldTouched,i=e.values;return Object($.jsxs)(pe.c,{className:"form ui",children:[Object($.jsx)(pe.b,{label:"Description",placeholder:"Description",name:"description",component:fe}),Object($.jsx)(pe.b,{label:"Date",placeholder:"YYYY-MM-DD",name:"date",component:xe,setFieldValue:a,setFieldTouched:r}),Object($.jsx)(pe.b,{label:"Specialist",placeholder:"Specialist",name:"specialist",component:fe}),Object($.jsx)(pe.b,{label:"Entry type",name:"type",setFieldValue:a,setFieldTouched:r,entryTypes:Object.values(v),component:ke,initialValue:null===j||void 0===j?void 0:j.type}),i.type===v.HealthCheckEntry&&Object($.jsx)(Ze,{label:"Health check rating",name:"healthCheckRating"}),i.type===v.HospitalEntry&&Object($.jsxs)(c.a.Fragment,{children:[Object($.jsx)(pe.b,{label:"Discharge Date",placeholder:"YYYY-MM-DD",name:"discharge.date",component:xe,setFieldValue:a,setFieldTouched:r}),Object($.jsx)(pe.b,{label:"Discharge criteria",placeholder:"criteria",name:"discharge.criteria",component:fe})]}),i.type===v.OccupationalHealthcareEntry&&Object($.jsxs)(c.a.Fragment,{children:[Object($.jsx)(pe.b,{label:"Empolyer Name",placeholder:"Employer name",name:"employerName",component:fe}),Object($.jsx)(pe.b,{label:"Sick Leave Start Date",placeholder:"YYYY-MM-DD",name:"sickLeave.startDate",component:xe,setFieldValue:a,setFieldTouched:r}),Object($.jsx)(pe.b,{label:"Sick Leave End Date",placeholder:"YYYY-MM-DD",name:"sickLeave.endDate",component:xe,setFieldValue:a,setFieldTouched:r})]}),Object($.jsx)(pe.b,{label:"Diagnosis",placeholder:"Diagnosis",name:"diagnosisCodes",diagnoses:Object.values(O),setFieldValue:a,setFieldTouched:r,component:ye,initialValues:null===j||void 0===j?void 0:j.diagnosisCodes,onSearchChange:F}),y&&!y.exists&&Object($.jsxs)("div",{children:[Object($.jsxs)("span",{children:["\u2018",y.query,"\u2019 does not exist in diagnoses."]}),"\xa0",Object($.jsx)("a",{href:"",onClick:function(e){e.preventDefault(),S(!0)},children:"Search or add it."})]}),Object($.jsxs)("div",{style:{marginLeft:"auto",marginRight:"auto",width:"max-content"},children:[Object($.jsx)(H.a,{color:"green",type:"submit",disabled:!n||!t,children:"Submit"}),Object($.jsx)(H.a,{color:"red",type:"button",onClick:function(){return d()},children:"Cancel"}),Object($.jsx)(H.a,{color:"blue",type:"reset",children:"Reset"})]})]})}}),Object($.jsx)($e,{modalOpen:E,onClose:function(){S(!1),k({query:"",exists:!0})},onSubmit:T,initialValues:void 0,error:R})]})},Ke=function(e){var t=e.modalOpen,n=e.onSubmit,a=e.onClose,r=e.initialValues,c=e.error;return Object($.jsxs)(je.a,{open:t,onClose:a,centered:!1,closeIcon:!0,children:[Object($.jsxs)(je.a.Header,{children:[void 0===r?"Add a new":"Edit"," entry"]}),Object($.jsxs)(je.a.Content,{children:[c&&Object($.jsx)(be.a,{inverted:!0,color:"red",children:"Error: ".concat(c)}),Object($.jsx)(Qe,{onSubmit:n,onCancel:a,initialValues:r})]})]})},We=function(){var e,t,n=Object(L.g)().id,a=W(),i=Object(l.a)(a,2),o=i[0].patients,d=i[1],b=c.a.useState(!1),h=Object(l.a)(b,2),f=h[0],m=h[1],x=c.a.useState(!1),g=Object(l.a)(x,2),y=g[0],C=g[1],w=Object(r.useState)(),E=Object(l.a)(w,2),S=E[0],D=E[1],N=["patientId","healthCheckRating","discharge","employerName","sickLeave"],R=Object(r.useState)(void 0),T=Object(l.a)(R,2),F=T[0],I=T[1],V=Object(r.useState)({}),_=Object(l.a)(V,2),M=_[0],U=_[1],Y=Object(L.f)(),B=c.a.useState(!1),G=Object(l.a)(B,2),z=G[0],q=G[1],J=c.a.useState(""),Z=Object(l.a)(J,2),Q=Z[0],K=Z[1],X=[{label:"edit",iconName:"edit",callback:function(e){return le?void le(e):void 0}},{label:"delete",iconName:"trash",callback:function(e){return oe(e.description,"Delete entry for ".concat(e.date,"?"),(function(){ue(e),ie()}))}}],ne=[{label:"edit",iconName:"edit",callback:function(e){be(e)}},{label:"delete",iconName:"trash",callback:function(e){return oe("Born on ".concat(e.dateOfBirth,", SSN ").concat(e.ssn),"Delete patient entry for ".concat(e.name,"?"),(function(){he(e.id),ie(),Y.push("/")}))}}],ae=function(){m(!0)},re=function(){m(!1),I(void 0),D(void 0)},ce=function(){C(!1),I(void 0),D(void 0)},ie=function(){U(Object(j.a)(Object(j.a)({},M),{},{open:!1,content:""}))},oe=function(e,t,n,a){U({header:t,content:e,open:!0,onConfirm:n||M.onConfirm,onCancel:a||ie})},se=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:a=Object.fromEntries(Object.entries(t).filter((function(e){var t=Object(l.a)(e,1)[0];return!N.includes(t)}))),e.t0=t.type,e.next=e.t0===v.HealthCheckEntry?6:e.t0===v.HospitalEntry?8:e.t0===v.OccupationalHealthcareEntry?10:12;break;case 6:return a=Object(j.a)(Object(j.a)({},a),{},{healthCheckRating:Number(t.healthCheckRating)}),e.abrupt("break",13);case 8:return a=Object(j.a)(Object(j.a)({},a),t.discharge&&{discharge:t.discharge}),e.abrupt("break",13);case 10:return a=Object(j.a)(Object(j.a)(Object(j.a)({},a),t.employerName&&{employerName:t.employerName}),t.sickLeave&&""!==t.sickLeave.startDate&&""!==t.sickLeave.endDate&&{sickLeave:t.sickLeave}),e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:if(e.prev=13,!F||null===t||void 0===t||!t.id){e.next=20;break}return e.next=17,A.put("".concat(p,"/patients/").concat(n,"/entries/").concat(t.id),Object(j.a)({id:t.id},a));case 17:r=e.sent,e.next=23;break;case 20:return e.next=22,A.post("".concat(p,"/patients/").concat(n,"/entries"),a);case 22:r=e.sent;case 23:d(ee(r.data)),re(),e.next=31;break;case 27:e.prev=27,e.t1=e.catch(13),console.error(e.t1),A.isAxiosError(e.t1)&&D(null===e.t1||void 0===e.t1||null===(c=e.t1.response)||void 0===c?void 0:c.data.error);case 31:case"end":return e.stop()}}),e,null,[[13,27]])})));return function(t){return e.apply(this,arguments)}}(),le=function(e){I(e),ae()},ue=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,A.delete("".concat(p,"/patients/").concat(n,"/entries/").concat(t.id));case 5:a=e.sent,r=a.data,d(ee(r)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,r,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,A.put("".concat(p,"/patients/").concat(n),Object.fromEntries(Object.entries(t).filter((function(e){var t=Object(l.a)(e,1)[0];return!["id","entries"].includes(t)}))));case 5:a=e.sent,r=a.data,d(ee(r)),ce(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),A.isAxiosError(e.t0)&&(console.log(null===(c=e.t0.response)||void 0===c?void 0:c.data),D(null===(i=e.t0.response)||void 0===i?void 0:i.data.error));case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),be=function(e){I(e),C(!0)},he=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.delete("".concat(p,"/patients/").concat(t));case 3:d(te(t)),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),A.isAxiosError(e.t0)&&D(null===e.t0||void 0===e.t0||null===(n=e.t0.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.error);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){!n||o[n]&&o[n].entries||(q(!0),k(n).then((function(e){d(ee(e))})).catch((function(e){console.error("Patient id ".concat(n," does not exist"),e)})).finally((function(){q(!1)})))}),[o[n||""]]),n&&null!==o[n]?void 0===o[n]?Object($.jsx)("div",{children:Object($.jsxs)("h2",{children:["Patient id ",n," does not exist!"]})}):Object($.jsxs)("div",{children:[Object($.jsxs)("div",{children:[Object($.jsx)("div",{style:{display:"inline-flex",justifyContent:"flex-end",position:"relative",width:"100%",top:"2.15rem"},children:ne.map((function(e){return Object($.jsx)("div",{style:{cursor:"pointer"},title:e.label,onClick:function(){return e.callback(o[n])},children:Object($.jsx)(de.a,{name:e.iconName})},"patient_action_".concat(e.label))}))}),Object($.jsxs)("div",{children:[Object($.jsxs)("h2",{children:[o[n].name,"\xa0",Object($.jsx)(de.a,{name:o[n].gender===O.Other?"genderless":o[n].gender===O.Male?"mars":"venus"})]}),Object($.jsx)(Le.a,{collapsing:!0,compact:!0,singleLine:!0,className:"no-border no-padding-left low-line-height",children:Object($.jsxs)(Le.a.Body,{children:[Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"SSN"}),Object($.jsx)(Le.a.Cell,{children:o[n].ssn})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Occupation"}),Object($.jsx)(Le.a.Cell,{children:o[n].occupation})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Date of birth"}),Object($.jsx)(Le.a.Cell,{children:o[n].dateOfBirth})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:"Health rating"}),Object($.jsx)(Le.a.Cell,{children:Object($.jsx)(Re,{showText:!0,rating:o[n].healthRating,inlineText:!0})})]})]})})]})]}),Object($.jsxs)("div",{children:[Object($.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1%",position:"relative",top:"2rem"},children:[Object($.jsx)("div",{style:{width:"max-content"},children:Object($.jsx)(Ie.a,{clearable:!0,disabled:0===(null===(e=o[n])||void 0===e||null===(t=e.entries)||void 0===t?void 0:t.length),placeholder:"filter entries by type",options:Object(P.a)(Object.values(v).map((function(e){return{key:e,text:e.split(/([A-Z][a-z]+)/).filter((function(e){return e})).join(" "),value:e}}))),onChange:function(e,t){return K(t.value)}})}),Object($.jsx)("div",{style:{width:"max-content"},children:Object($.jsx)(H.a,{as:"a",onClick:function(){return ae()},children:"add entry"})})]}),Object($.jsxs)("div",{children:[Object($.jsx)("h3",{children:"entries"}),z?Object($.jsx)(Ve.a,{active:!0,content:"Fetching entries"}):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object($.jsx)(c.a.Fragment,{children:n&&o[n].entries&&o[n].entries.length>0?Object($.jsx)(He.a,{children:o[n].entries.filter((function(t){var n;return null===t||void 0===t||null===(n=t.type)||void 0===n?void 0:n.includes(e)})).map((function(e){return Object($.jsx)(Ye,{entry:e,actions:X,onEdit:le,onDelete:ue},e.id)}))}):Object($.jsx)("em",{children:"no entries"})})}(Q)]})]}),Object($.jsx)(Ke,{modalOpen:f,onSubmit:se,onClose:re,initialValues:F}),Object($.jsx)(Ee,{modalOpen:y,onSubmit:je,onClose:ce,error:S,initialValues:F}),Object($.jsx)(_e.a,Object(j.a)({},M))]}):null},Xe=function(){var e=W(),t=Object(l.a)(e,2),n=t[0].diagnoses,a=t[1],i=c.a.useState(!1),o=Object(l.a)(i,2),d=o[0],b=o[1],h=c.a.useState(),O=Object(l.a)(h,2),v=O[0],f=O[1],m=c.a.useState(),x=Object(l.a)(m,2),g=x[0],y=x[1],k=[{label:"edit",iconName:"edit",arg:"code",callback:function(e){V(e)}},{label:"delete",iconName:"trash",arg:"code",callback:function(e){return L("Delete diagnosis ".concat(e," ").concat(n[e].name,"?"),(function(){I(e),R()}))}}],C=Object(r.useState)({}),w=Object(l.a)(C,2),E=w[0],S=w[1],D=function(){return b(!0)},N=function(){b(!1),f(void 0),y(void 0)},R=function(){S(Object(j.a)(Object(j.a)({},E),{},{open:!1,content:""}))},L=function(e,t,n){S({content:e,open:!0,onConfirm:t||E.onConfirm,onCancel:n||R})},F=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0!==g){e.next=7;break}return e.next=4,A.post("".concat(p,"/diagnoses"),t);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,A.put("".concat(p,"/diagnoses/").concat(t.code),t);case 9:e.t0=e.sent;case 10:n=e.t0,r=n.data,a(ae(r)),N(),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(0),A.isAxiosError(e.t1)&&(console.error((null===(c=e.t1.response)||void 0===c?void 0:c.data)||"Unknown Error"),f((null===(i=e.t1.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.error)||"Unknown error"));case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.delete("".concat(p,"/diagnoses/").concat(t));case 3:a(re(t)),N(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),A.isAxiosError(e.t0)&&(console.error((null===(n=e.t0.response)||void 0===n?void 0:n.data)||"Unknown Error"),f((null===(r=e.t0.response)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.error)||"Unknown error"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),V=function(e){y(n[e]),D()};return Object(r.useEffect)((function(){var e=function(){var e=Object(s.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.get("".concat(p,"/diagnoses"));case 3:t=e.sent,n=t.data,a(ne(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();n||e(),S(Object(j.a)(Object(j.a)({},E),{},{onCancel:R}))}),[]),Object($.jsxs)("div",{className:"App",children:[Object($.jsx)(T.a,{textAlign:"center",children:Object($.jsx)("h3",{children:"Diagnosis list"})}),Object($.jsx)("div",{style:{maxHeight:"75vh",overflowY:"auto",margin:"1em 0"},children:Object($.jsx)(Te,{data:Object.values(n).map((function(e){return e})),header:[{key:"code",sortable:!0},{key:"name",sortable:!0},{key:"latin",sortable:!1}],sortFunc:function(e,t){return function(n,a){return void 0===e?0:n[e]&&a[e]?"string"===typeof n[e]?n[e].localeCompare(a[e],"en",{sensitivity:"base"})*(t?1:-1):n[e].localeCompare(a[e],"en",{numeric:!0})*(t?1:-1):0}},actions:k.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{arg:"code"})}))})}),Object($.jsx)($e,{modalOpen:d,onSubmit:F,error:v,onClose:N,initialValues:g}),Object($.jsx)(H.a,{onClick:function(){return D()},children:"Add New Diagnosis"}),Object($.jsx)(_e.a,Object(j.a)({},E))]})};!function(e){e.auth="auth",e.register="register"}(se||(se={}));var et=function(e){var t=e.onSubmit,n=e.type,a=void 0===n?se.auth:n,i=Object(r.useState)(a),o=Object(l.a)(i,2),s=o[0],d=o[1],u=Object(r.useRef)(null);Object(r.useEffect)((function(){if(void 0===t[s])throw new Error("Function for ".concat(s," must be provided"));u.current&&(u.current.values.username="",u.current.values.password="",u.current.values.name="")}),[s]);return Object($.jsxs)(c.a.Fragment,{children:[Object($.jsxs)("h3",{children:[Object($.jsx)("a",{onClick:function(e){e.preventDefault(),s!==se.auth&&d(se.auth)},href:s!==se.auth?"":void 0,style:Object(j.a)({},s===se.auth&&{color:"black"}),children:"Login"}),"\xa0or\xa0",Object($.jsx)("a",{onClick:function(e){e.preventDefault(),s!==se.register&&d(se.register)},href:s!==se.register?"":void 0,style:Object(j.a)({},s===se.register&&{color:"black"}),children:"Register"})]}),Object($.jsx)(pe.d,{innerRef:u,initialValues:{username:"",password:"",name:""},onSubmit:t[s],validate:function(e){var t="Field is required",n={};return e.username||(n.username=t),e.password||(n.password=t),n},children:function(e){var t=e.isValid,n=e.dirty;return Object($.jsxs)(pe.c,{className:"form ui",children:[Object($.jsx)(pe.b,{label:"Username",placeholder:"Username",name:"username",component:fe}),s===se.register&&Object($.jsx)(pe.b,{label:"Name",placeholder:"Name",name:"name",component:fe}),Object($.jsx)(pe.b,{label:"Password",placeholder:"Password",name:"password",type:"password",component:fe}),Object($.jsx)(he.a,{children:Object($.jsx)(he.a.Column,{width:5,children:Object($.jsx)(H.a,{type:"submit",color:"green",disabled:!n||!t,children:s===se.auth?"Login":"Register"})})})]})}})]})},tt=function(){var e,t=Object(L.g)().id,n=W(),a=Object(l.a)(n,2)[1],i=Object(r.useState)(void 0),o=Object(l.a)(i,2),s=o[0],d=o[1],u=Object(r.useState)(!1),j=Object(l.a)(u,2),b=j[0],h=j[1];return Object(r.useEffect)((function(){h(!0),t&&C(t).then((function(e){d(e)})).catch((function(e){var t;(console.log(e),d(void 0),A.isAxiosError(e))&&(a(ie({text:{content:null===(t=e.response)||void 0===t?void 0:t.data.error,header:"Operation Failed"},type:m.error})),setTimeout((function(){a({type:"CLEAR_MESSAGE"})}),3e3))})).finally((function(){h(!1)}))}),[t]),t?Object($.jsxs)(c.a.Fragment,{children:[Object($.jsx)(F.a,{as:"h3",children:"User Info"}),b?Object($.jsx)(Ve.a,{active:!0,content:"Fetching info for user id ".concat(t)}):s?Object($.jsx)(Le.a,{compact:!0,celled:!0,collapsing:!0,className:"no-border no-padding-left",children:Object($.jsxs)(Le.a.Body,{children:[Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:Object($.jsx)("strong",{children:"Username"})}),Object($.jsx)(Le.a.Cell,{children:s.username})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:Object($.jsx)("strong",{children:"Name"})}),Object($.jsx)(Le.a.Cell,{children:null===s||void 0===s?void 0:s.name})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:Object($.jsx)("strong",{children:"ID"})}),Object($.jsx)(Le.a.Cell,{children:s.id})]}),Object($.jsxs)(Le.a.Row,{children:[Object($.jsx)(Le.a.Cell,{children:Object($.jsx)("strong",{children:"Roles"})}),Object($.jsx)(Le.a.Cell,{children:null===s||void 0===s||null===(e=s.roles)||void 0===e?void 0:e.map((function(e){return e.name})).join(", ")})]})]})}):Object($.jsx)(F.a,{as:"h2",children:"No info"})]}):null},nt=function(){var e=W(),t=Object(l.a)(e,2),n=t[0],a=n.auth,i=n.scheduler,o=n.message,d=t[1],j=void 0;c.a.useEffect((function(){var e=JSON.parse(localStorage.getItem("auth")||"null");d(ce(e)),e&&x(e.token),window.addEventListener("beforeunload",(function(){return b()}))}),[]),c.a.useEffect((function(){var e=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=d,e.t1=X,e.next=5,y();case 5:e.t2=e.sent,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3),e.next=13;break;case 10:e.prev=10,e.t4=e.catch(0),console.error(e.t4);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.get("".concat(p,"/diagnoses"));case 3:t=e.sent,n=t.data,d(ne(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();console.log("user is logged ".concat(a?"in":"out")),a&&a.token?(e(),t(),console.log("will schedule access token refresh"),j=function(e,t){if(e&&!(new Date(1e3*e.exp)<new Date)){var n=Math.max(1e3*e.exp-Date.now()-1e4,0),a=setTimeout((function(){N().then((function(e){t(e),console.log("refreshed access token on ".concat((new Date).toString()))})).catch((function(e){console.log(e)}))}),n);return console.log("access token refresh scheduled to run in ".concat(n/1e3," seconds [").concat(new Date(Date.now()+n).toString(),"]")),a}}(a,(function(e){d(ce(e)),e&&x(e.token),localStorage.setItem("auth",JSON.stringify(e)),d({type:"REMOVE_SCHEDULED"})}))):b()}),[d,null===a||void 0===a?void 0:a.id,null===a||void 0===a?void 0:a.token]),Object(r.useEffect)((function(){if(void 0===j)return b(),localStorage.removeItem("auth");d({type:"ADD_SCHEDULED",payload:j}),console.log("refreshHandler",j)}),[j]);var b=function(){i.forEach((function(e,t,n){clearTimeout(e),t===n.length-1&&console.log("cleared ".concat(t+1," scheduled tasks"))})),d({type:"REMOVE_ALL_SCHEDULED"})},h=function(e,t){E(e,t).then((function(e){console.log("access token",e),d(ce(e)),localStorage.setItem("auth",JSON.stringify(e)),d(ie({text:{content:"Logged in successfully as ".concat((null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.username)||""),header:"Authentication Completed"},type:m.success})),setTimeout((function(){d({type:"CLEAR_MESSAGE"})}),3e3)})).catch((function(e){var t;(console.log(e),A.isAxiosError(e))&&(d(ie({text:{content:null===(t=e.response)||void 0===t?void 0:t.data.error,header:"Authentication Failed"},type:m.error})),setTimeout((function(){d({type:"CLEAR_MESSAGE"})}),3e3))}))},O=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=12;break}return e.prev=1,e.next=4,S(a.id);case 4:200===e.sent.status&&(localStorage.removeItem("auth"),d({type:"LOGOUT"})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),d(ie({text:{header:"Authentication Failed",content:"Logout failed for ".concat(a.name||a.username,".")},type:m.error}));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return Object($.jsx)("div",{className:"App",children:Object($.jsx)(R.a,{children:Object($.jsxs)(T.a,{children:[Object($.jsx)(F.a,{as:"h1",children:"Patientor"}),(null===a||void 0===a?void 0:a.token)&&Object($.jsxs)(c.a.Fragment,{children:[Object($.jsxs)(T.a,{fluid:!0,style:{position:"relative"},children:[Object($.jsx)(H.a,{as:R.b,to:"/",primary:!0,children:"Home"}),Object($.jsx)(H.a,{as:R.b,to:"/diagnoses",secondary:!0,children:"Diagnoses"}),Object($.jsxs)(T.a,{style:{display:"inline-flex",width:"fit-content",height:"100%",position:"absolute",right:"0",alignItems:"center"},children:[Object($.jsxs)("span",{children:["logged in as ",Object($.jsx)(R.b,{to:"/users/".concat(a.id),children:Object($.jsx)("strong",{children:a.name||a.username})}),"\xa0"]}),Object($.jsx)(H.a,{basic:!0,size:"tiny",floated:"right",icon:"log out",content:"log out",title:"log out",onClick:function(){O()}})]})]}),Object($.jsx)(I.a,{hidden:!0}),Object($.jsxs)(L.c,{children:[Object($.jsx)(L.a,{path:"/patients/:id",children:Object($.jsx)(We,{})}),Object($.jsx)(L.a,{path:"/diagnoses",children:Object($.jsx)(Xe,{})}),Object($.jsx)(L.a,{path:"/users/:id",children:Object($.jsx)(tt,{})}),Object($.jsx)(L.a,{exact:!0,path:"/",children:Object($.jsx)(Fe,{})}),Object($.jsx)(L.a,{path:"*",children:Object($.jsxs)(V.a,{error:!0,children:[Object($.jsx)(V.a.Header,{children:"Error 404"}),Object($.jsx)("p",{children:"This page does not exist!"})]})})]})]}),!(null!==a&&void 0!==a&&a.token)&&Object($.jsx)(et,{onSubmit:{auth:function(e){h(e.username,e.password)},register:function(e){var t,n,a;t=e.username,n=e.password,a=e.name,D(t,n,a).then((function(e){console.log("created user",e),d(ie({text:{header:"Authentication Completed",content:"User ".concat(e.name||e.username," was created")},type:m.success}))})).then((function(){setTimeout((function(){h(t,n)}),1500)})).catch((function(e){var t;A.isAxiosError(e)?console.log("axios error",e.code,null===(t=e.response)||void 0===t?void 0:t.data):console.log(e)}))}}}),Object($.jsxs)(V.a,{hidden:!(null!==o&&void 0!==o&&o.show),error:"error"===(null===o||void 0===o?void 0:o.type),success:"success"===(null===o||void 0===o?void 0:o.type),warning:"warning"===(null===o||void 0===o?void 0:o.type),info:"info"===(null===o||void 0===o?void 0:o.type),onDismiss:function(){d({type:"CLEAR_MESSAGE"})},style:{position:"fixed",bottom:".5%",width:"inherit"},children:[(null===o||void 0===o?void 0:o.text.header)&&Object($.jsx)(V.a.Header,{children:o.text.header}),Object($.jsx)(V.a.Content,{children:null===o||void 0===o?void 0:o.text.content})]})]})})})};o.a.render(Object($.jsx)(K,{reducer:function(e,t){var n=e.patients,a=e.diagnoses,r=e.auth,c=e.scheduler,i=e.message;return{patients:U(n,t),diagnoses:B(a,t),auth:G(r,t),scheduler:q(c,t),message:J(i,t)}},children:Object($.jsx)(nt,{})}),document.getElementById("root"))}},[[223,1,2]]]);
//# sourceMappingURL=main.23f598e7.chunk.js.map